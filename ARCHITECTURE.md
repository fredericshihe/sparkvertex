# SparkVertex (çµæ¢) - é¡¹ç›®æ¶æ„æ–‡æ¡£

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

**SparkVertexï¼ˆçµæ¢ï¼‰** æ˜¯ä¸€ä¸ªåŸºäº **Local-First** ç†å¿µçš„ AI é©±åŠ¨åº”ç”¨ç”Ÿæˆä¸åˆ†å‘å¹³å°ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡è‡ªç„¶è¯­è¨€æè¿°ï¼Œç”± AI è‡ªåŠ¨ç”Ÿæˆå®Œæ•´çš„ Web åº”ç”¨ä»£ç ï¼Œå¹¶æ”¯æŒ PWA å®‰è£…ã€åœ¨çº¿é¢„è§ˆå’Œç¤¾åŒºåˆ†äº«ã€‚

---

## ğŸ—ï¸ æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                   SparkVertex ç³»ç»Ÿæ¶æ„                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚     ç”¨æˆ·ç«¯ (Client)   â”‚
                              â”‚  â€¢ æµè§ˆå™¨ (Web/PWA)   â”‚
                              â”‚  â€¢ Electron æ¡Œé¢ç«¯    â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                    â”‚                    â”‚
                    â–¼                    â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Next.js å‰ç«¯        â”‚ â”‚     Next.js API        â”‚ â”‚   Supabase Edge Func    â”‚
â”‚   (React + Tailwind)    â”‚ â”‚    (Route Handlers)    â”‚ â”‚   (Deno Runtime)        â”‚
â”‚                         â”‚ â”‚                         â”‚ â”‚                         â”‚
â”‚  â€¢ é¡µé¢æ¸²æŸ“ (SSR/SSG)    â”‚ â”‚  â€¢ /api/generate       â”‚ â”‚  â€¢ generate-app         â”‚
â”‚  â€¢ çŠ¶æ€ç®¡ç† (Context)    â”‚ â”‚  â€¢ /api/analyze        â”‚ â”‚  â€¢ deepseek-chat        â”‚
â”‚  â€¢ å›½é™…åŒ– (i18n)         â”‚ â”‚  â€¢ /api/payment/*      â”‚ â”‚  â€¢ embed                â”‚
â”‚  â€¢ PWA æ”¯æŒ             â”‚ â”‚  â€¢ /api/cron/*         â”‚ â”‚  â€¢ score-items          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                           â”‚                           â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚                â”‚                â”‚
                         â–¼                â–¼                â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   Supabase DB   â”‚ â”‚  å¤–éƒ¨ AI æœåŠ¡    â”‚ â”‚   æ”¯ä»˜æœåŠ¡       â”‚
              â”‚  (PostgreSQL)   â”‚ â”‚                 â”‚ â”‚                 â”‚
              â”‚                 â”‚ â”‚  â€¢ Gemini API   â”‚ â”‚  â€¢ æ”¯ä»˜å®        â”‚
              â”‚  â€¢ items        â”‚ â”‚  â€¢ DeepSeek API â”‚ â”‚  â€¢ çˆ±å‘ç”µ        â”‚
              â”‚  â€¢ profiles     â”‚ â”‚  â€¢ Embeddings   â”‚ â”‚                 â”‚
              â”‚  â€¢ orders       â”‚ â”‚                 â”‚ â”‚                 â”‚
              â”‚  â€¢ rag_logs     â”‚ â”‚                 â”‚ â”‚                 â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ é¡¹ç›®ç›®å½•ç»“æ„

```
spark-vertex-next/
â”œâ”€â”€ app/                          # Next.js App Router (é¡µé¢ & API)
â”‚   â”œâ”€â”€ layout.tsx                # æ ¹å¸ƒå±€ (å…¨å±€ Provider)
â”‚   â”œâ”€â”€ page.tsx                  # é¦–é¡µ
â”‚   â”œâ”€â”€ globals.css               # å…¨å±€æ ·å¼
â”‚   â”‚
â”‚   â”œâ”€â”€ api/                      # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ generate/             # AI ä»£ç ç”Ÿæˆ (æ ¸å¿ƒ)
â”‚   â”‚   â”œâ”€â”€ analyze/              # AI éœ€æ±‚åˆ†æ
â”‚   â”‚   â”œâ”€â”€ embed/                # å‘é‡åµŒå…¥
â”‚   â”‚   â”œâ”€â”€ payment/              # æ”¯ä»˜ç›¸å…³
â”‚   â”‚   â”‚   â”œâ”€â”€ create/           # åˆ›å»ºæ”¯ä»˜è®¢å•
â”‚   â”‚   â”‚   â”œâ”€â”€ notify/           # æ”¯ä»˜å›è°ƒ
â”‚   â”‚   â”‚   â”œâ”€â”€ check-status/     # æŸ¥è¯¢æ”¯ä»˜çŠ¶æ€
â”‚   â”‚   â”‚   â””â”€â”€ afdian/           # çˆ±å‘ç”µæ”¯ä»˜
â”‚   â”‚   â”œâ”€â”€ cron/                 # å®šæ—¶ä»»åŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ cleanup-orders/   # æ¸…ç†è¿‡æœŸè®¢å•
â”‚   â”‚   â”‚   â”œâ”€â”€ health-check/     # å¥åº·æ£€æŸ¥
â”‚   â”‚   â”‚   â””â”€â”€ retry-credits/    # ç§¯åˆ†é‡è¯•
â”‚   â”‚   â”œâ”€â”€ refund/               # é€€æ¬¾å¤„ç†
â”‚   â”‚   â”œâ”€â”€ generate-icon/        # å›¾æ ‡ç”Ÿæˆ
â”‚   â”‚   â”œâ”€â”€ manifest/[id]/        # åŠ¨æ€ PWA manifest
â”‚   â”‚   â””â”€â”€ score-item/           # ä½œå“è¯„åˆ†
â”‚   â”‚
â”‚   â”œâ”€â”€ create/                   # åˆ›ä½œé¡µé¢ (AI ç”Ÿæˆ)
â”‚   â”œâ”€â”€ explore/                  # çµæ¢å¹¿åœº (ä½œå“æµè§ˆ)
â”‚   â”œâ”€â”€ profile/                  # ä¸ªäººä¸­å¿ƒ
â”‚   â”œâ”€â”€ upload/                   # ä¸Šä¼ ä½œå“
â”‚   â”œâ”€â”€ p/[id]/                   # ä½œå“è¯¦æƒ…é¡µ
â”‚   â”œâ”€â”€ preview/                  # é¢„è§ˆé¡µé¢
â”‚   â”œâ”€â”€ guide/                    # å¼€å‘æŒ‡å—
â”‚   â”œâ”€â”€ why/                      # æ ¸å¿ƒç†å¿µ
â”‚   â”œâ”€â”€ auth/                     # è®¤è¯å›è°ƒ
â”‚   â””â”€â”€ update-password/          # æ›´æ–°å¯†ç 
â”‚
â”œâ”€â”€ components/                   # React ç»„ä»¶
â”‚   â”œâ”€â”€ Navbar.tsx                # å¯¼èˆªæ 
â”‚   â”œâ”€â”€ Footer.tsx                # é¡µè„š
â”‚   â”œâ”€â”€ Hero.tsx                  # é¦–é¡µ Hero åŒºåŸŸ
â”‚   â”œâ”€â”€ ProjectCard.tsx           # ä½œå“å¡ç‰‡
â”‚   â”‚
â”‚   â”œâ”€â”€ CreationChat.tsx          # AI åˆ›ä½œå¯¹è¯ç•Œé¢
â”‚   â”œâ”€â”€ CreationPreview.tsx       # ä»£ç é¢„è§ˆç»„ä»¶
â”‚   â”œâ”€â”€ AIWorkflowProgress.tsx    # AI å·¥ä½œæµè¿›åº¦
â”‚   â”œâ”€â”€ GenerationProgress.tsx    # ç”Ÿæˆè¿›åº¦å±•ç¤º
â”‚   â”œâ”€â”€ CodeWaterfall.tsx         # ä»£ç ç€‘å¸ƒæµæ•ˆæœ
â”‚   â”‚
â”‚   â”œâ”€â”€ DetailModal.tsx           # ä½œå“è¯¦æƒ…å¼¹çª—
â”‚   â”œâ”€â”€ LoginModal.tsx            # ç™»å½•å¼¹çª—
â”‚   â”œâ”€â”€ PaymentModal.tsx          # æ”¯ä»˜å¼¹çª—
â”‚   â”œâ”€â”€ CreditPurchaseModal.tsx   # ç§¯åˆ†å……å€¼å¼¹çª—
â”‚   â”œâ”€â”€ ConfirmModal.tsx          # é€šç”¨ç¡®è®¤å¼¹çª—
â”‚   â”œâ”€â”€ FeedbackModal.tsx         # åé¦ˆå¼¹çª—
â”‚   â”œâ”€â”€ EditProfileModal.tsx      # ç¼–è¾‘èµ„æ–™å¼¹çª—
â”‚   â”œâ”€â”€ RewardModal.tsx           # æ‰“èµå¼¹çª—
â”‚   â”‚
â”‚   â”œâ”€â”€ CityBackground.tsx        # åŸå¸‚èƒŒæ™¯åŠ¨ç”»
â”‚   â”œâ”€â”€ SkeletonLoader.tsx        # éª¨æ¶å±åŠ è½½
â”‚   â”œâ”€â”€ Toast.tsx                 # Toast æç¤º
â”‚   â”œâ”€â”€ WeChatGuard.tsx           # å¾®ä¿¡æµè§ˆå™¨æ£€æµ‹
â”‚   â””â”€â”€ ServiceWorkerRegister.tsx # PWA Service Worker
â”‚
â”œâ”€â”€ context/                      # React Context (çŠ¶æ€ç®¡ç†)
â”‚   â”œâ”€â”€ LanguageContext.tsx       # å›½é™…åŒ–è¯­è¨€åˆ‡æ¢
â”‚   â”œâ”€â”€ ModalContext.tsx          # å…¨å±€å¼¹çª—çŠ¶æ€
â”‚   â””â”€â”€ ToastContext.tsx          # Toast é€šçŸ¥çŠ¶æ€
â”‚
â”œâ”€â”€ lib/                          # å·¥å…·åº“ & æ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ supabase.ts               # Supabase å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ utils.ts                  # é€šç”¨å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ cache.ts                  # ç¼“å­˜ç®¡ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ prompts.ts                # AI Prompt æ¨¡æ¿
â”‚   â”œâ”€â”€ ai-analysis.ts            # AI åˆ†æå·¥å…·
â”‚   â”œâ”€â”€ intent-classifier.ts      # ç”¨æˆ·æ„å›¾åˆ†ç±»å™¨
â”‚   â”œâ”€â”€ code-rag.ts               # ä»£ç  RAG æ£€ç´¢
â”‚   â”œâ”€â”€ rag.ts                    # RAG ä¸»é€»è¾‘
â”‚   â”œâ”€â”€ rag-logger.ts             # RAG æ—¥å¿—è®°å½•
â”‚   â”œâ”€â”€ ast-parser.ts             # AST ä»£ç è§£æ
â”‚   â”œâ”€â”€ patch.ts                  # ä»£ç è¡¥ä¸åº”ç”¨
â”‚   â”œâ”€â”€ preview.ts                # é¢„è§ˆå†…å®¹å¤„ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ alipay.ts                 # æ”¯ä»˜å® SDK
â”‚   â”œâ”€â”€ afdian.ts                 # çˆ±å‘ç”µ API
â”‚   â”œâ”€â”€ rate-limit.ts             # è¯·æ±‚é™æµ
â”‚   â”œâ”€â”€ sha256.ts                 # ç­¾åå·¥å…·
â”‚   â”‚
â”‚   â”œâ”€â”€ categories.ts             # ä½œå“åˆ†ç±»å®šä¹‰
â”‚   â””â”€â”€ i18n/                     # å›½é™…åŒ–
â”‚       â””â”€â”€ translations.ts       # ä¸­è‹±æ–‡ç¿»è¯‘
â”‚
â”œâ”€â”€ supabase/                     # Supabase é…ç½® & å‡½æ•°
â”‚   â”œâ”€â”€ config.toml               # Supabase æœ¬åœ°é…ç½®
â”‚   â”œâ”€â”€ migrations/               # æ•°æ®åº“è¿ç§»è„šæœ¬
â”‚   â””â”€â”€ functions/                # Edge Functions
â”‚       â”œâ”€â”€ generate-app/         # AI ä»£ç ç”Ÿæˆ
â”‚       â”œâ”€â”€ generate-app-async/   # å¼‚æ­¥ç”Ÿæˆ
â”‚       â”œâ”€â”€ deepseek-chat/        # DeepSeek èŠå¤©
â”‚       â”œâ”€â”€ embed/                # å‘é‡åµŒå…¥
â”‚       â”œâ”€â”€ score-items/          # ä½œå“è¯„åˆ†
â”‚       â”œâ”€â”€ analyze-html/         # HTML åˆ†æ
â”‚       â”œâ”€â”€ daily-recommendation/ # æ¯æ—¥æ¨è
â”‚       â””â”€â”€ send-auth-email/      # è®¤è¯é‚®ä»¶
â”‚
â”œâ”€â”€ types/                        # TypeScript ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ supabase.ts               # æ•°æ®åº“ç±»å‹
â”‚
â”œâ”€â”€ public/                       # é™æ€èµ„æº
â”‚   â”œâ”€â”€ manifest.json             # PWA Manifest
â”‚   â”œâ”€â”€ sw.js                     # Service Worker
â”‚   â””â”€â”€ icons/                    # å›¾æ ‡èµ„æº
â”‚
â”œâ”€â”€ electron/                     # Electron æ¡Œé¢ç«¯
â”œâ”€â”€ dist-electron/                # Electron æ‰“åŒ…è¾“å‡º
â”‚
â”œâ”€â”€ middleware.ts                 # Next.js ä¸­é—´ä»¶
â”œâ”€â”€ next.config.js                # Next.js é…ç½®
â”œâ”€â”€ tailwind.config.ts            # Tailwind CSS é…ç½®
â”œâ”€â”€ tsconfig.json                 # TypeScript é…ç½®
â””â”€â”€ vercel.json                   # Vercel éƒ¨ç½²é…ç½®
```

---

## ğŸ”„ æ ¸å¿ƒä¸šåŠ¡æµç¨‹

### 1. AI ä»£ç ç”Ÿæˆæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·è¾“å…¥éœ€æ±‚  â”‚â”€â”€â”€â–¶â”‚  æ„å›¾åˆ†ç±»     â”‚â”€â”€â”€â–¶â”‚  RAG æ£€ç´¢    â”‚â”€â”€â”€â–¶â”‚  ä»£ç å‹ç¼©     â”‚
â”‚  (è‡ªç„¶è¯­è¨€)   â”‚    â”‚  (DeepSeek)  â”‚    â”‚  (pgvector)  â”‚    â”‚  (AST è§£æ)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                    â”‚
                                                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å±•ç¤ºé¢„è§ˆ     â”‚â—€â”€â”€â”€â”‚  è¡¥ä¸åº”ç”¨     â”‚â—€â”€â”€â”€â”‚  æµå¼è¾“å‡º     â”‚â—€â”€â”€â”€â”‚  Gemini ç”Ÿæˆ  â”‚
â”‚  (iframe)    â”‚    â”‚  (diff-match) â”‚    â”‚  (SSE)       â”‚    â”‚  (Pro/Flash) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. æ”¯ä»˜æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é€‰æ‹©å¥—é¤    â”‚â”€â”€â”€â–¶â”‚  åˆ›å»ºè®¢å•    â”‚â”€â”€â”€â–¶â”‚  ç”Ÿæˆæ”¯ä»˜ç   â”‚â”€â”€â”€â–¶â”‚  ç”¨æˆ·æ‰«ç æ”¯ä»˜ â”‚
â”‚  (å‰ç«¯)     â”‚    â”‚  /api/create â”‚    â”‚  (QR Code)  â”‚    â”‚  (æ”¯ä»˜å®)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                â”‚
                                                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å……å€¼æˆåŠŸ    â”‚â—€â”€â”€â”€â”‚  å¢åŠ ç§¯åˆ†    â”‚â—€â”€â”€â”€â”‚  æ›´æ–°è®¢å•    â”‚â—€â”€â”€â”€â”‚  æ”¯ä»˜å›è°ƒ    â”‚
â”‚  (å‰ç«¯åˆ·æ–°)  â”‚    â”‚  (DB RPC)   â”‚    â”‚  (çŠ¶æ€æ›´æ–°)  â”‚    â”‚  /api/notifyâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. ä½œå“å‘å¸ƒæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”Ÿæˆä»£ç     â”‚â”€â”€â”€â–¶â”‚  å‘å¸ƒä½œå“    â”‚â”€â”€â”€â–¶â”‚  AI è¯„åˆ†     â”‚â”€â”€â”€â–¶â”‚  å±•ç¤ºåœ¨å¹¿åœº  â”‚
â”‚  (create)   â”‚    â”‚  (DB å†™å…¥)  â”‚    â”‚  (score-item)â”‚    â”‚  (explore)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡ (Supabase PostgreSQL)

### æ ¸å¿ƒè¡¨ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          profiles (ç”¨æˆ·è¡¨)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (uuid, PK)          â”‚ ç”¨æˆ· ID (å…³è” auth.users)                   â”‚
â”‚ username               â”‚ ç”¨æˆ·å                                      â”‚
â”‚ avatar_url             â”‚ å¤´åƒ URL                                    â”‚
â”‚ bio                    â”‚ ä¸ªäººç®€ä»‹                                    â”‚
â”‚ payment_qr             â”‚ æ”¶æ¬¾äºŒç»´ç                                    â”‚
â”‚ credits                â”‚ ç§¯åˆ†ä½™é¢                                    â”‚
â”‚ daily_reward_date      â”‚ æœ€åé¢†å–æ¯æ—¥å¥–åŠ±çš„æ—¥æœŸ                        â”‚
â”‚ created_at             â”‚ æ³¨å†Œæ—¶é—´                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           items (ä½œå“è¡¨)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (uuid, PK)          â”‚ ä½œå“ ID                                     â”‚
â”‚ title                  â”‚ æ ‡é¢˜                                        â”‚
â”‚ description            â”‚ æè¿°                                        â”‚
â”‚ content                â”‚ HTML ä»£ç å†…å®¹                               â”‚
â”‚ prompt                 â”‚ ç”Ÿæˆæ—¶çš„ Prompt                             â”‚
â”‚ author_id (FK)         â”‚ ä½œè€… ID                                     â”‚
â”‚ category               â”‚ åˆ†ç±» (game/tool/design...)                  â”‚
â”‚ tags                   â”‚ æ ‡ç­¾æ•°ç»„                                    â”‚
â”‚ icon_url               â”‚ å›¾æ ‡ URL                                    â”‚
â”‚ is_public              â”‚ æ˜¯å¦å…¬å¼€                                    â”‚
â”‚ is_draft               â”‚ æ˜¯å¦è‰ç¨¿                                    â”‚
â”‚ views / likes          â”‚ æµè§ˆ/ç‚¹èµæ•°                                 â”‚
â”‚ quality_score          â”‚ AI è´¨é‡è¯„åˆ†                                 â”‚
â”‚ total_score            â”‚ ç»¼åˆè¯„åˆ†                                    â”‚
â”‚ analysis_reason        â”‚ AI è¯„åˆ†ç†ç”±                                 â”‚
â”‚ created_at             â”‚ åˆ›å»ºæ—¶é—´                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       generation_tasks (ç”Ÿæˆä»»åŠ¡è¡¨)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (uuid, PK)          â”‚ ä»»åŠ¡ ID                                     â”‚
â”‚ user_id (FK)           â”‚ ç”¨æˆ· ID                                     â”‚
â”‚ prompt                 â”‚ ç”¨æˆ·è¾“å…¥çš„ Prompt                            â”‚
â”‚ status                 â”‚ çŠ¶æ€ (pending/processing/completed/failed)  â”‚
â”‚ result                 â”‚ ç”Ÿæˆç»“æœ                                    â”‚
â”‚ cost                   â”‚ æ¶ˆè€—ç§¯åˆ†                                    â”‚
â”‚ model                  â”‚ ä½¿ç”¨çš„æ¨¡å‹                                   â”‚
â”‚ error_message          â”‚ é”™è¯¯ä¿¡æ¯                                    â”‚
â”‚ created_at             â”‚ åˆ›å»ºæ—¶é—´                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          orders (è®¢å•è¡¨)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (uuid, PK)          â”‚ è®¢å• ID                                     â”‚
â”‚ buyer_id (FK)          â”‚ ä¹°å®¶ ID                                     â”‚
â”‚ item_id (FK)           â”‚ ä½œå“ ID (å¯é€‰)                               â”‚
â”‚ amount                 â”‚ é‡‘é¢                                        â”‚
â”‚ credits                â”‚ è·å¾—ç§¯åˆ†                                    â”‚
â”‚ status                 â”‚ çŠ¶æ€ (pending/paid/expired)                 â”‚
â”‚ payment_type           â”‚ æ”¯ä»˜æ–¹å¼ (alipay/afdian)                    â”‚
â”‚ trade_no               â”‚ å¹³å°äº¤æ˜“å·                                   â”‚
â”‚ created_at             â”‚ åˆ›å»ºæ—¶é—´                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       code_embeddings (ä»£ç å‘é‡è¡¨)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (uuid, PK)          â”‚ å‘é‡ ID                                     â”‚
â”‚ item_id (FK)           â”‚ å…³è”ä½œå“                                    â”‚
â”‚ chunk_id               â”‚ ä»£ç å—æ ‡è¯†                                   â”‚
â”‚ content                â”‚ ä»£ç å†…å®¹                                    â”‚
â”‚ embedding (vector 768) â”‚ å‘é‡åµŒå…¥ (pgvector)                         â”‚
â”‚ created_at             â”‚ åˆ›å»ºæ—¶é—´                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         rag_logs (RAG æ—¥å¿—è¡¨)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (uuid, PK)          â”‚ æ—¥å¿— ID                                     â”‚
â”‚ user_id (FK)           â”‚ ç”¨æˆ· ID                                     â”‚
â”‚ user_query             â”‚ ç”¨æˆ·æŸ¥è¯¢                                    â”‚
â”‚ detected_intent        â”‚ æ£€æµ‹åˆ°çš„æ„å›¾                                 â”‚
â”‚ intent_confidence      â”‚ æ„å›¾ç½®ä¿¡åº¦                                   â”‚
â”‚ intent_source          â”‚ æ¥æº (local/deepseek)                       â”‚
â”‚ intent_latency_ms      â”‚ æ„å›¾åˆ†ç±»å»¶è¿Ÿ                                 â”‚
â”‚ rag_latency_ms         â”‚ RAG æ£€ç´¢å»¶è¿Ÿ                                â”‚
â”‚ created_at             â”‚ åˆ›å»ºæ—¶é—´                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§  AI ç³»ç»Ÿæ¶æ„

### æ„å›¾åˆ†ç±»ç³»ç»Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Intent Classifier (æ„å›¾åˆ†ç±»å™¨)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚   ç”¨æˆ·è¾“å…¥ â”€â”€â–¶ æœ¬åœ°å…³é”®è¯åŒ¹é… â”€â”€â”¬â”€â”€â–¶ é«˜ç½®ä¿¡åº¦ (>0.7) â”€â”€â–¶ ç›´æ¥è¿”å›    â”‚
â”‚                               â”‚                                     â”‚
â”‚                               â””â”€â”€â–¶ ä½ç½®ä¿¡åº¦ â”€â”€â–¶ DeepSeek API â”€â”€â–¶ è¿”å›â”‚
â”‚                                                                     â”‚
â”‚   æ”¯æŒçš„æ„å›¾ç±»å‹:                                                    â”‚
â”‚   â€¢ UI_MODIFICATION  - æ”¹é¢œè‰²ã€å¸ƒå±€ã€æ ·å¼                             â”‚
â”‚   â€¢ LOGIC_FIX        - ä¿®å¤ Bugã€ä¸šåŠ¡é€»è¾‘                            â”‚
â”‚   â€¢ CONFIG_HELP      - ç¯å¢ƒå˜é‡ã€é…ç½®é—®é¢˜                             â”‚
â”‚   â€¢ NEW_FEATURE      - æ–°å¢åŠŸèƒ½                                      â”‚
â”‚   â€¢ REFACTOR         - ä»£ç é‡æ„                                      â”‚
â”‚   â€¢ DATA_OPERATION   - æ•°æ®åº“ã€API æ“ä½œ                              â”‚
â”‚   â€¢ BACKEND_SETUP    - åç«¯é…ç½®                                      â”‚
â”‚   â€¢ GLOBAL_REVIEW    - å…¨å±€ä»£ç å®¡æŸ¥                                   â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### RAG æ£€ç´¢ç³»ç»Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Code RAG System                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚   1. ä»£ç åˆ†å— (chunkCode)                                           â”‚
â”‚      â””â”€â”€ AST è§£æ â†’ æŒ‰ç»„ä»¶/å‡½æ•°/å¸¸é‡åˆ†å—                             â”‚
â”‚                                                                     â”‚
â”‚   2. å‘é‡åµŒå…¥ (embedCode)                                           â”‚
â”‚      â””â”€â”€ Gemini gemini-embedding-001 â†’ 768 ç»´å‘é‡                   â”‚
â”‚                                                                     â”‚
â”‚   3. ç›¸ä¼¼åº¦æœç´¢ (findRelevantCodeChunks)                            â”‚
â”‚      â””â”€â”€ pgvector ä½™å¼¦ç›¸ä¼¼åº¦ â†’ Top-K ç›¸å…³ä»£ç å—                      â”‚
â”‚                                                                     â”‚
â”‚   4. ä»£ç å‹ç¼© (compressCode)                                        â”‚
â”‚      â””â”€â”€ ç§»é™¤æ³¨é‡Š/ç©ºè¡Œ â†’ å‹ç¼©å˜é‡å â†’ ç”Ÿæˆæ‘˜è¦                       â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### AI æ¨¡å‹é…ç½®

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Model Configuration                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚   Gemini 2.5 Flash âš¡                                               â”‚
â”‚   â”œâ”€â”€ ç”¨é€”: æ—¥å¸¸ä¿®æ”¹ã€ç®€å•ä»»åŠ¡                                        â”‚
â”‚   â”œâ”€â”€ é€Ÿåº¦: æœ€å¿«                                                     â”‚
â”‚   â””â”€â”€ Token/ç§¯åˆ†: 15000                                             â”‚
â”‚                                                                     â”‚
â”‚   Gemini 2.5 Pro ğŸš€                                                 â”‚
â”‚   â”œâ”€â”€ ç”¨é€”: å¤æ‚ä»»åŠ¡ã€é»˜è®¤é€‰é¡¹                                        â”‚
â”‚   â”œâ”€â”€ é€Ÿåº¦: å‡è¡¡                                                     â”‚
â”‚   â””â”€â”€ Token/ç§¯åˆ†: 4000                                              â”‚
â”‚                                                                     â”‚
â”‚   Gemini 3 Pro ğŸ§  (Preview)                                         â”‚
â”‚   â”œâ”€â”€ ç”¨é€”: é«˜è´¨é‡ã€å¤æ‚é€»è¾‘                                          â”‚
â”‚   â”œâ”€â”€ é€Ÿåº¦: è¾ƒæ…¢                                                     â”‚
â”‚   â””â”€â”€ Token/ç§¯åˆ†: 3000                                              â”‚
â”‚                                                                     â”‚
â”‚   DeepSeek (æ„å›¾åˆ†ç±»ä¸“ç”¨)                                            â”‚
â”‚   â””â”€â”€ ç”¨äºä½ç½®ä¿¡åº¦åœºæ™¯ä¸‹çš„æ„å›¾è¯†åˆ«å¢å¼º                                 â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸŒ å‰ç«¯æ¶æ„

### çŠ¶æ€ç®¡ç† (React Context)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Context Providers                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚   LanguageProvider                                                  â”‚
â”‚   â”œâ”€â”€ language: 'zh' | 'en'                                         â”‚
â”‚   â”œâ”€â”€ setLanguage()                                                 â”‚
â”‚   â””â”€â”€ t: translations[language]                                     â”‚
â”‚                                                                     â”‚
â”‚   ModalProvider                                                     â”‚
â”‚   â”œâ”€â”€ isLoginModalOpen / openLoginModal / closeLoginModal           â”‚
â”‚   â”œâ”€â”€ isDetailModalOpen / openDetailModal / closeDetailModal        â”‚
â”‚   â”œâ”€â”€ isPaymentModalOpen / openPaymentModal / closePaymentModal     â”‚
â”‚   â”œâ”€â”€ isCreditPurchaseModalOpen / openCreditPurchaseModal           â”‚
â”‚   â”œâ”€â”€ isConfirmModalOpen / openConfirmModal / closeConfirmModal     â”‚
â”‚   â””â”€â”€ ... (å…¶ä»–å¼¹çª—çŠ¶æ€)                                             â”‚
â”‚                                                                     â”‚
â”‚   ToastProvider                                                     â”‚
â”‚   â”œâ”€â”€ success(message)                                              â”‚
â”‚   â””â”€â”€ error(message)                                                â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é¡µé¢ç»„ä»¶å…³ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         layout.tsx (æ ¹å¸ƒå±€)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚   â”œâ”€â”€ LanguageProvider                                              â”‚
â”‚   â”‚   â””â”€â”€ ToastProvider                                             â”‚
â”‚   â”‚       â””â”€â”€ ModalProvider                                         â”‚
â”‚   â”‚           â”œâ”€â”€ CityBackground (èƒŒæ™¯åŠ¨ç”»)                          â”‚
â”‚   â”‚           â”œâ”€â”€ Navbar (å¯¼èˆªæ )                                    â”‚
â”‚   â”‚           â”œâ”€â”€ {children} (é¡µé¢å†…å®¹)                              â”‚
â”‚   â”‚           â”œâ”€â”€ Footer (é¡µè„š)                                      â”‚
â”‚   â”‚           â”‚                                                     â”‚
â”‚   â”‚           â”œâ”€â”€ LoginModal                                        â”‚
â”‚   â”‚           â”œâ”€â”€ DetailModal                                       â”‚
â”‚   â”‚           â”œâ”€â”€ PaymentModal                                      â”‚
â”‚   â”‚           â”œâ”€â”€ CreditPurchaseModal                               â”‚
â”‚   â”‚           â”œâ”€â”€ ConfirmModal                                      â”‚
â”‚   â”‚           â””â”€â”€ ... (å…¶ä»–å…¨å±€å¼¹çª—)                                  â”‚
â”‚   â”‚                                                                 â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”Œ API æ¥å£è®¾è®¡

### ä»£ç ç”Ÿæˆ API

```
POST /api/generate
Headers: Accept: text/event-stream (SSE)

Request:
{
  "type": "modification" | "creation",
  "user_prompt": "ç”¨æˆ·æè¿°",
  "current_code": "ç°æœ‰ä»£ç  (ä¿®æ”¹æ—¶)",
  "model": "gemini-2.5-pro",
  "skip_compression": false
}

SSE Events:
â”œâ”€â”€ { type: "thinking", data: { reasoning, intent, targets } }
â”œâ”€â”€ { type: "progress", data: { stage, message } }
â”œâ”€â”€ { type: "result", data: { code, taskId, cost, summary } }
â””â”€â”€ { type: "error", data: { error, message } }
```

### æ”¯ä»˜ API

```
POST /api/payment/create
{
  "amount": 9.9,
  "credits": 100,
  "payment_type": "alipay"
}
Response: { order_id, qr_code_url }

POST /api/payment/notify (å›è°ƒ)
æ”¯ä»˜å®å¼‚æ­¥é€šçŸ¥ â†’ éªŒç­¾ â†’ æ›´æ–°è®¢å• â†’ å¢åŠ ç§¯åˆ†

GET /api/payment/check-status?order_id=xxx
Response: { status: "paid" | "pending" | "expired" }
```

---

## ğŸš€ éƒ¨ç½²æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Vercel (å‰ç«¯ + API)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚   Next.js Application                                               â”‚
â”‚   â”œâ”€â”€ Static Pages (SSG): /, /guide, /why                           â”‚
â”‚   â”œâ”€â”€ Dynamic Pages (SSR): /explore, /p/[id], /profile              â”‚
â”‚   â”œâ”€â”€ API Routes: /api/*                                            â”‚
â”‚   â””â”€â”€ Edge Middleware: middleware.ts                                â”‚
â”‚                                                                     â”‚
â”‚   Cron Jobs (vercel.json):                                          â”‚
â”‚   â”œâ”€â”€ /api/cron/health-check   (æ¯ 5 åˆ†é’Ÿ)                          â”‚
â”‚   â”œâ”€â”€ /api/cron/cleanup-orders (æ¯å°æ—¶)                             â”‚
â”‚   â””â”€â”€ /api/cron/retry-credits  (æ¯ 10 åˆ†é’Ÿ)                         â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Supabase (åç«¯æœåŠ¡)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚   PostgreSQL Database                                               â”‚
â”‚   â”œâ”€â”€ ç”¨æˆ·è®¤è¯ (auth.users)                                         â”‚
â”‚   â”œâ”€â”€ ä¸šåŠ¡æ•°æ® (public.*)                                           â”‚
â”‚   â”œâ”€â”€ å‘é‡æœç´¢ (pgvector extension)                                 â”‚
â”‚   â””â”€â”€ RLS è¡Œçº§å®‰å…¨ç­–ç•¥                                               â”‚
â”‚                                                                     â”‚
â”‚   Edge Functions (Deno)                                             â”‚
â”‚   â”œâ”€â”€ generate-app: AI ä»£ç ç”Ÿæˆ                                      â”‚
â”‚   â”œâ”€â”€ deepseek-chat: DeepSeek API ä»£ç†                              â”‚
â”‚   â”œâ”€â”€ embed: å‘é‡åµŒå…¥ç”Ÿæˆ                                            â”‚
â”‚   â””â”€â”€ score-items: ä½œå“è¯„åˆ†                                          â”‚
â”‚                                                                     â”‚
â”‚   Storage                                                           â”‚
â”‚   â”œâ”€â”€ avatars: ç”¨æˆ·å¤´åƒ                                              â”‚
â”‚   â””â”€â”€ icons: ä½œå“å›¾æ ‡                                                â”‚
â”‚                                                                     â”‚
â”‚   Realtime                                                          â”‚
â”‚   â””â”€â”€ è®¢å•çŠ¶æ€/ç§¯åˆ†å˜æ›´å®æ—¶æ¨é€                                        â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” å®‰å…¨è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Security Layers                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚   1. è®¤è¯å±‚ (Supabase Auth)                                         â”‚
â”‚      â”œâ”€â”€ é‚®ç®±/å¯†ç ç™»å½•                                               â”‚
â”‚      â”œâ”€â”€ ç¬¬ä¸‰æ–¹ OAuth (Google/GitHub)                               â”‚
â”‚      â””â”€â”€ JWT Token éªŒè¯                                             â”‚
â”‚                                                                     â”‚
â”‚   2. API å±‚                                                         â”‚
â”‚      â”œâ”€â”€ è¯·æ±‚ç­¾åéªŒè¯ (æ”¯ä»˜å›è°ƒ)                                      â”‚
â”‚      â”œâ”€â”€ Rate Limiting (é™æµ)                                       â”‚
â”‚      â””â”€â”€ CORS é…ç½®                                                  â”‚
â”‚                                                                     â”‚
â”‚   3. æ•°æ®åº“å±‚ (RLS)                                                 â”‚
â”‚      â”œâ”€â”€ ç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„æ•°æ®                                       â”‚
â”‚      â”œâ”€â”€ å…¬å¼€ä½œå“æ‰€æœ‰äººå¯è§                                          â”‚
â”‚      â””â”€â”€ ç§¯åˆ†æ“ä½œä»…é€šè¿‡ RPC å‡½æ•°                                      â”‚
â”‚                                                                     â”‚
â”‚   4. å‰ç«¯å±‚                                                         â”‚
â”‚      â”œâ”€â”€ iframe sandbox (é¢„è§ˆéš”ç¦»)                                   â”‚
â”‚      â”œâ”€â”€ CSP å†…å®¹å®‰å…¨ç­–ç•¥                                            â”‚
â”‚      â””â”€â”€ æ•æ„Ÿä¿¡æ¯è„±æ•                                                â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š æŠ€æœ¯æ ˆæ€»ç»“

| å±‚çº§ | æŠ€æœ¯é€‰å‹ |
|------|----------|
| **å‰ç«¯æ¡†æ¶** | Next.js 14 (App Router) |
| **UI æ¡†æ¶** | React 18 + Tailwind CSS |
| **çŠ¶æ€ç®¡ç†** | React Context |
| **å›½é™…åŒ–** | è‡ªç ” i18n (translations.ts) |
| **æ•°æ®åº“** | Supabase (PostgreSQL + pgvector) |
| **è®¤è¯** | Supabase Auth |
| **åç«¯å‡½æ•°** | Supabase Edge Functions (Deno) |
| **AI æœåŠ¡** | Google Gemini API + DeepSeek API |
| **æ”¯ä»˜** | æ”¯ä»˜å® + çˆ±å‘ç”µ |
| **éƒ¨ç½²** | Vercel (å‰ç«¯) + Supabase (åç«¯) |
| **PWA** | next-pwa + Service Worker |
| **æ¡Œé¢ç«¯** | Electron (å®éªŒæ€§) |

---

## ğŸ“ ç‰ˆæœ¬ä¿¡æ¯

- **é¡¹ç›®åç§°**: SparkVertex (çµæ¢)
- **ç‰ˆæœ¬**: 0.1.0
- **æ–‡æ¡£æ›´æ–°**: 2025-12-09
